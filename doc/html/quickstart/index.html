<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">

	<title>Quick Start - Fit</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="../css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            

            <!-- Main title -->
            <a class="navbar-brand" href="../index.html">Fit</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            
                <!-- Main navigation -->
                <ul class="nav navbar-nav">
                
                
                    <li >
                        <a href="../index.html">Home</a>
                    </li>
                
                
                
                    <li class="dropdown active">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">About <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li class="active">
                                <a href="index.html">Quick Start</a>
                            </li>
                        
                            <li >
                                <a href="../concepts/index.html">Basic Concepts</a>
                            </li>
                        
                            <li >
                                <a href="../requirements/index.html">Requirements</a>
                            </li>
                        
                            <li >
                                <a href="../acknowledgements/index.html">Acknowledgements</a>
                            </li>
                        
                            <li >
                                <a href="../license/index.html">License</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Adaptors <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../by/index.html">by</a>
                            </li>
                        
                            <li >
                                <a href="../compose/index.html">compose</a>
                            </li>
                        
                            <li >
                                <a href="../conditional/index.html">conditional</a>
                            </li>
                        
                            <li >
                                <a href="../fix/index.html">fix</a>
                            </li>
                        
                            <li >
                                <a href="../flip/index.html">flip</a>
                            </li>
                        
                            <li >
                                <a href="../implicit/index.html">implicit</a>
                            </li>
                        
                            <li >
                                <a href="../indirect/index.html">indirect</a>
                            </li>
                        
                            <li >
                                <a href="../infix/index.html">infix</a>
                            </li>
                        
                            <li >
                                <a href="../lazy/index.html">lazy</a>
                            </li>
                        
                            <li >
                                <a href="../match/index.html">match</a>
                            </li>
                        
                            <li >
                                <a href="../mutable/index.html">mutable</a>
                            </li>
                        
                            <li >
                                <a href="../partial/index.html">partial</a>
                            </li>
                        
                            <li >
                                <a href="../pipable/index.html">pipable</a>
                            </li>
                        
                            <li >
                                <a href="../protect/index.html">protect</a>
                            </li>
                        
                            <li >
                                <a href="../result/index.html">result</a>
                            </li>
                        
                            <li >
                                <a href="../reveal/index.html">reveal</a>
                            </li>
                        
                            <li >
                                <a href="../static/index.html">static</a>
                            </li>
                        
                            <li >
                                <a href="../unpack/index.html">unpack</a>
                            </li>
                        
                            <li >
                                <a href="../variadic/index.html">variadic</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Functions <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../always/index.html">always</a>
                            </li>
                        
                            <li >
                                <a href="../args/index.html">args</a>
                            </li>
                        
                            <li >
                                <a href="../identity/index.html">identity</a>
                            </li>
                        
                            <li >
                                <a href="../placeholders/index.html">placeholders</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                
                    <li class="dropdown">
                        <a href="#" class="dropdown-toggle" data-toggle="dropdown">Utilities <b class="caret"></b></a>
                        <ul class="dropdown-menu">
                        
                            <li >
                                <a href="../apply/index.html">apply</a>
                            </li>
                        
                            <li >
                                <a href="../apply_eval/index.html">apply_eval</a>
                            </li>
                        
                            <li >
                                <a href="../capture/index.html">capture</a>
                            </li>
                        
                            <li >
                                <a href="../eval/index.html">eval</a>
                            </li>
                        
                            <li >
                                <a href="../function/index.html">FIT_STATIC_FUNCTION</a>
                            </li>
                        
                            <li >
                                <a href="../lambda/index.html">FIT_STATIC_LAMBDA</a>
                            </li>
                        
                            <li >
                                <a href="../lift/index.html">lift</a>
                            </li>
                        
                            <li >
                                <a href="../is_callable/index.html">is_callable</a>
                            </li>
                        
                            <li >
                                <a href="../pack/index.html">pack</a>
                            </li>
                        
                            <li >
                                <a href="../returns/index.html">returns</a>
                            </li>
                        
                            <li >
                                <a href="../tap/index.html">tap</a>
                            </li>
                        
                        </ul>
                    </li>
                
                
                </ul>
            

            
            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                
                <li >
                    <a rel="next" href="../index.html">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../concepts/index.html">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                
                <li>
                    <a href="https://github.com/pfultz2/Fit">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#quick-start">Quick Start</a></li>
        
            <li><a href="#function-objects">Function Objects</a></li>
        
            <li><a href="#adaptors">Adaptors</a></li>
        
            <li><a href="#lambdas">Lambdas</a></li>
        
            <li><a href="#overloading">Overloading</a></li>
        
            <li><a href="#recursive">Recursive</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="quick-start">Quick Start</h1>
<h2 id="function-objects">Function Objects</h2>
<p>In C++, a function object is just a class that overrides the call operator like this:</p>
<pre><code>// A sum function object
struct sum_f
{
    template&lt;class T, class U&gt;
    auto operator()(T x, U y) const
    {
        return x + y;
    }
};
</code></pre>
<p>There are few things to note about this. First, the call operator member function is always declared <code>const</code>, which is generally required to be used with Fit.(Note: The <code>mutable_</code> adaptor can be used to make a mutable function object have a <code>const</code> call operator, but this should generally be avoided). Secondly, the <code>sum_f</code> class must be constructed first before it can be called:</p>
<pre><code>auto three = sum_f()(1, 2);
</code></pre>
<p>We can make it behave like a regular function if we construct the class as a global variable. However, we want to statically initialize it(ie initialize it at compile-time) to avoid the static initialization order fiasco. We can do that using <code>constexpr</code> like this:</p>
<pre><code>const constexpr sum_f sum = {};
</code></pre>
<p>However, when we declare function objects globally, we want to make sure they have the same address across translation units in order to avoid ODR violations. This can be done by declaring the function object using the <code>FIT_STATIC_FUNCTION</code> macro:</p>
<pre><code>FIT_STATIC_FUNCTION(sum) = sum_f();
</code></pre>
<h2 id="adaptors">Adaptors</h2>
<p>Now we have defined the function as a function object, we can add new "enhancements" to the function. We could make the function pipable using the pipable adaptor:</p>
<pre><code>const constexpr pipable_adaptor&lt;sum_f&gt; sum = {};
</code></pre>
<p>So it could be called like this:</p>
<pre><code>auto three = 1 | sum(2);
</code></pre>
<p>Or we could make it an infix named operator as well using the infix adaptor:</p>
<pre><code>const constexpr infix_adaptor&lt;sum_f&gt; sum = {};
</code></pre>
<p>And it could be called like this:</p>
<pre><code>auto three = 1 &lt;sum&gt; 2;
</code></pre>
<p>Additionally each of the adaptors have a corresponding function version without the <code>_adaptor</code> suffix. So we could pass <code>sum</code> as a variable to the adaptors to make new functions. So we can do things like partial application and function composition if we wanted to:</p>
<pre><code>auto add_1 = partial(sum)(1);
auto add_2 = compose(add_1, add_1);
auto three = add_2(1);
</code></pre>
<h2 id="lambdas">Lambdas</h2>
<p>Instead of writing function objects which can be a little verbose, we can write the functions as lambdas instead. However, by default lambdas cannot be statically initialized at compile time. So we can use the <code>FIT_STATIC_LAMBDA</code> to initialize them at compile time:</p>
<pre><code>const constexpr auto sum = FIT_STATIC_LAMBDA(auto x, auto y)
{
    return x + y;
};
</code></pre>
<p>And we can apply the same adaptors as well:</p>
<pre><code>// Pipable sum
const constexpr auto sum = pipable(FIT_STATIC_LAMBDA(auto x, auto y)
{
    return x + y;
});
</code></pre>
<p>We can also use <code>FIT_STATIC_LAMBDA_FUNCTION</code> to ensure that <code>sum</code> will always have an unique address across translation units, even when using lambdas.</p>
<pre><code>// Pipable sum
FIT_STATIC_LAMBDA_FUNCTION(sum) = pipable([](auto x, auto y)
{
    return x + y;
});
</code></pre>
<p>As we will see, this can help make it cleaner when we are defining several lambdas, such as for overloading.</p>
<h2 id="overloading">Overloading</h2>
<p>Now, Fit provides two ways of doing overloading. The <code>match</code> adaptor will call a function based on C++ overload resolution, which tries to find the best match, like this:</p>
<pre><code>FIT_STATIC_LAMBDA_FUNCTION(print) = match(
    [](int x)
    {
        std::cout &lt;&lt; "Integer: " &lt;&lt; x &lt;&lt; std::endl;
    },
    [](const std::string&amp; x)
    {
        std::cout &lt;&lt; "String: " &lt;&lt; x &lt;&lt; std::endl;
    }
);
</code></pre>
<p>However, when trying to do overloading involving something more generic, it can lead to ambiguities. So the <code>conditional</code> adaptor will pick the first function that is callable. This allows ordering the functions based on which one is more important. So if we wanted to write a function to print all the values in a type including primitive types as well as ranges, we could write something like this:</p>
<pre><code>#define REQUIRES(...) typename std::enable_if&lt;(__VA_ARGS__), int&gt;::type = 0

FIT_STATIC_LAMBDA_FUNCTION(print) = conditional(
    [](auto x, REQUIRES(std::is_fundamental&lt;decltype(x)&gt;()))
    {
        std::cout &lt;&lt; x &lt;&lt; std::endl;
    },
    [](const std::string&amp; x)
    {
        std::cout &lt;&lt; x &lt;&lt; std::endl;
    },
    [](const auto&amp; range)
    {
        for(const auto&amp; x:range) 
            std::cout &lt;&lt; x &lt;&lt; std::endl;
    }
);
</code></pre>
<p>We constraint the first lambda to just fundamental types using <code>REQUIRES</code>. The last lambda we assume it is a range(we should check if it is a range but that is beyond the scope of this guide), and it is only called if the first two lambdas cannot be called(ie the type is not a fundamental nor a string).</p>
<h2 id="recursive">Recursive</h2>
<p>Additionally, we could go a step further and make the <code>print</code> function recursive. We can use the <code>fix</code> adaptor, which implements a fix point combinator. So the first parameter of the function will be the function itself:</p>
<pre><code>FIT_STATIC_LAMBDA_FUNCTION(print) = fix(conditional(
    [](auto, auto x, REQUIRES(std::is_fundamental&lt;decltype(x)&gt;()))
    {
        std::cout &lt;&lt; x &lt;&lt; std::endl;
    },
    [](auto, const std::string&amp; x)
    {
        std::cout &lt;&lt; x &lt;&lt; std::endl;
    },
    [](auto self, const auto&amp; range)
    {
        for(const auto&amp; x:range) self(x);
    }
));
</code></pre></div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="../js/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/highlight.pack.js"></script>
        <script src="../js/base.js"></script>
        <script src="../js/configure.js"></script>

        <!--
        MkDocs version  : 0.12.2
        Docs Build Date : 2015-05-31 02:50:29.527097
        -->
    </body>
</html>